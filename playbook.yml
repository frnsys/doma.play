- name: install dependencies (system)
  apt:
    pkg:
      - python3
      - python3-pip
      - python3-tk
      - redis-server
      - tzdata
    state: present
- name: Copy app files
  synchronize:
    src: ~/work/doma/doma.play/
    dest: /srv/app/
    delete: yes
- name: Install dependencies (app)
  pip: requirements=/srv/app/requirements.txt executable=pip3
- name: overwrite start.sh
  copy:
    content: "#!/bin/bash\ncd /srv/app\nredis-server &\npython3 main.py &\npython3 app.py &\nwait"
    dest: /usr/share/start.sh